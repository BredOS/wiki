---
title: systemd-nspawn ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’ç®¡ç†
description:
published: false
date: 2025-09-25T07:02:39.910Z
tags:
editor: markdown
dateCreated: 2025-09-25T07:02:39.910Z
---

# ğŸ”„ 1. å…¥é–€æƒ…å ±

`systemd-nspawn` ã¯ã€ã‚³ãƒãƒ³ãƒ‰ã‚„OSç’°å¢ƒã‚’å³å¯†ã«éš”é›¢ã•ã‚ŒãŸç’°å¢ƒã§å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚ŒãŸè»½é‡ã®ã‚³ãƒ³ãƒ†ãƒŠãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ å¤šãã®å ´åˆã€ã€Œã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã®ã‚¯ãƒ­ãƒ¼ãƒˆã€ã¨ã—ã¦è¨˜è¿°ã•ã‚Œã¦ã„ã¾ã™ã€‚ Linux ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã¾ãŸã¯æœ€å°é™ã®ç’°å¢ƒã‚’å®‰å…¨ã‹ã¤åˆ¶å¾¡ã•ã‚ŒãŸæ–¹æ³•ã§ãƒ†ã‚¹ãƒˆã¾ãŸã¯å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ä¾¿åˆ©ãªæ–¹æ³•ã‚’æä¾›ã—ã¾ã™ã€‚

QEMUã‚„Dockerã®ã‚ˆã†ãªã‚³ãƒ³ãƒ†ãƒŠãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ã‚ˆã†ãªå®Œå…¨ãªä»®æƒ³åŒ–ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ç•°ãªã‚Šã€`systemd-nspawn`ã¯Linuxåå‰ç©ºé–“ã¨cgroupsã‚’ä½¿ç”¨ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒã»ã¨ã‚“ã©ãªã„ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã—ã¾ã™ã€‚

# 3. ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆ

nspawn ã‚’ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ä»»æ„ã®å ´æ‰€ã‹ã‚‰å®Ÿè¡Œã§ãã¾ã™ãŒã€æ¨å¥¨ãƒ•ã‚©ãƒ«ãƒ€ã¯ `/var/lib/machines` ã§ã™ã€‚ ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã«ã€Linux/GNU rootfsã‚’ä¿æŒã™ã‚‹ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã™ã€‚ ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç°¡å˜ã«ã™ã‚‹ãŸã‚ã«ã€ã“ã®è¨˜äº‹ã§ã¯ã‚³ãƒ³ãƒ†ãƒŠãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚ ãã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹ã‚’æ–°ã—ã„å ´æ‰€ã«ã‚³ãƒ”ãƒ¼ã—ã€æ–°ã—ã„ã‚³ãƒ³ãƒ†ãƒŠç’°å¢ƒã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

- ãƒ«ãƒ¼ãƒˆã«åˆ‡ã‚Šæ›¿ãˆã‚‹:

```
sudo su
```

- æ¬¡ã«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ `/var/lib/machines`ã«å¤‰æ›´ã—ã¾ã™ã€‚

```
cd /var/lib/mains
```

- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã™ã€‚

```
mkdir ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```

ã‚³ãƒ³ãƒ†ãƒŠã¯ã©ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒˆã‚’ã‚‚ã¤ã“ã¨ãŒã§ãã‚‹ã®ã§ã€ã‚ãªãŸã¯æ¯”è¼ƒçš„è‡ªç”±ã«é¸æŠã§ãã¾ã™ã€‚ Debianã€Ubuntuã€BredOSãªã©ã€æœ€å°é™ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®tarballã®ãƒªã‚¹ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚ ãŸã ã—ã€ã“ã®è¨˜äº‹ã¯ç‰¹ã«ãƒ–ãƒ¬ãƒƒãƒ‰OSã‚³ãƒ³ãƒ†ãƒŠç”¨ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

> ã‚³ãƒ³ãƒ†ãƒŠãƒ¼å†…ã§å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚³ãƒãƒ³ãƒ‰ã¯ã€BredOS ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„å ´åˆã¯ã€ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒªã‚¢ãƒ³ãƒˆã«å¾“ã£ã¦èª¿æ•´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
> {.is-warning}

- [Ubuntu-base](https://cdimage.ubuntu.com/ubuntu-base/releases/) é¸æŠè‚¢ã®ãƒªãƒªãƒ¼ã‚¹ã‚’èª¿ã¹ã¦ã€CPU ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç”¨ã® .tar.gz ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
- [Debian genericcloud](https://cloud.debian.org/images/cloud/) ä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„ãƒªãƒªãƒ¼ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€CPU ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç”¨ã® .tar.gz ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
- [Fedora Container Base](https://fedoraproject.org/misc#minimal) ä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã€Container Baseã¾ãŸã¯Container Minimal Baseã‚’é¸æŠã—ã¾ã™ã€‚
- [Arch Linux](https://archlinux.org/download/) Choose a mirror near you, then download the .tar.zst file.
- [Arch Linux ARM](https://archlinuxarm.org/os/) aarch64 ã¾ãŸã¯ armv7 ã‚¿ã‚°ã® .tar.gz ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
  {.links-list}

é¸æŠã—ãŸ rootfs ã‚¿ãƒ¼ãƒœãƒ¼ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚‰ã€ãã‚Œã‚’æŠ½å‡ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã®ä¾‹ã§ã¯ã€Arch Linux ARM tarball ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ã‚ã¨ã§ BredOS ã«å¤‰æ›ã—ã¾ã™ã€‚

- tarball ã‚’ `/var/lib/machines/template` ã«å±•é–‹ã—ã¾ã™ã€‚

```
sudo tar -xzf <your distro's tarball of choice> -C /var/lib/machines/template
```

- `template` ãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```
ls template/
bin boot dev etc home lib mnt opt proc root run sbin srv syss tmp usr var
```

